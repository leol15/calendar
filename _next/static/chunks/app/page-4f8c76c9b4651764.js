(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{11299:()=>{},80527:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ed});var a=n(95155),r=n(5459),i=n(12115),s=n(34540),l=n(20935),d=n(67371),o=n(45132),c=n(40947),v=n(28538),u=n(14408),h=n(5058),E=n(2395),y=n(51990),p=n(78966),g=n.n(p),m=n(32813),j=n.n(m),x=n(70954),f=n.n(x),b=function(e){return e.Monday="Monday",e.Tuesday="Tuesday",e.Wednesday="Wednesday",e.Thursday="Thursday",e.Friday="Friday",e.Saturday="Saturday",e.Sunday="Sunday",e}({});let S="schedule-events",A=[b.Monday,b.Tuesday,b.Wednesday,b.Thursday,b.Friday,b.Saturday,b.Sunday],C=e=>{let[t,n,a,r=255]=e;return"rgba(".concat(t,", ").concat(n,", ").concat(a,", ").concat(r,")")},k={toString:e=>{let t=Math.floor((e%=1440)/60),n=e%60,a=String(t).padStart(2,"0"),r=String(n).padStart(2,"0");return"".concat(a,":").concat(r)},fromString:e=>{let[t,n]=e.split(":").map(Number);return 60*(t||0)+(n||0)}},N={serialize:e=>JSON.stringify(e),deserialize:e=>{try{return JSON.parse(e)}catch(e){return console.error("Error deserializing events:",e),[]}}},w=e=>{window.localStorage.setItem(S,N.serialize(e))},M=()=>{var e;return N.deserialize((null==(e=window)?void 0:e.localStorage.getItem(S))||"[]")},z=()=>{let e=M(),t=N.serialize(e);navigator.clipboard.writeText(t)},B=async()=>{let e=await navigator.clipboard.readText();try{let t=N.deserialize(e);w(t)}catch(e){console.error("Error pasting events:",e)}},I=()=>{let e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),n=Math.floor(256*Math.random());return .299*e+.587*t+.114*n<120?I():[e,t,n]},D=(0,y.Z0)({name:"weekEvents",initialState:{eventsById:{},ids:[]},reducers:{upsertEvent:(e,t)=>{e.eventsById[t.payload.id]=t.payload,e.ids.includes(t.payload.id)||(e.ids.push(t.payload.id),e.ids.sort((e,t)=>e-t)),w(Object.values(e.eventsById))},removeEvent:(e,t)=>{e.eventsById=f()(e.eventsById,t.payload),e.ids=e.ids.filter(e=>e!==t.payload),w(Object.values(e.eventsById))},clearEvents:e=>{e.eventsById={},e.ids=[],w(Object.values(e.eventsById))},reloadFromLocalStorage:e=>{let t=M();e.eventsById={},e.ids=[],t.forEach(t=>{e.eventsById[t.id]=t,e.ids.push(t.id)}),e.ids.sort((e,t)=>e-t)}}}),{upsertEvent:O,removeEvent:T,clearEvents:H,reloadFromLocalStorage:F}=D.actions,_={createEvent:e=>(t,n)=>{let a=n(),r=(a.weekEvents.ids[a.weekEvents.ids.length-1]||0)+1,i={id:0,name:"New event ".concat(r),days:[b.Monday],start:0,duration:60},s=j()({},i,e,{id:r});return console.log("leoooo createEvent",e,s),t(O(s)),s},upsertEvent:O,removeEvent:T,reloadFromLocalStorage:F},Y=D.reducer,P={eventsByDay:(e,t)=>Object.values(e.eventsById).filter(e=>e.days.includes(t))},W=(0,y.Z0)({name:"editEvent",initialState:{isEditing:!1,event:null},reducers:{startEditEvent:(e,t)=>{e.isEditing||(e.isEditing=!0,e.event=g()(t.payload))},updateEvent:(e,t)=>{e.isEditing&&(e.event=t.payload)},endEditEvent:e=>{e.isEditing=!1,e.event=null}}}),R=W.reducer,Z={startEditEvent:e=>(t,n)=>{let a=n().weekEvents.eventsById[e];a&&t(W.actions.startEditEvent(a))},updateEditEvent:W.actions.updateEvent,cancelEditEvent:()=>e=>{e(W.actions.endEditEvent())},saveEditEvent:()=>(e,t)=>{let n=t();n.editEvent.event&&e(_.upsertEvent(n.editEvent.event)),e(W.actions.endEditEvent())},deleteEvent:()=>(e,t)=>{let n=t();n.editEvent.event&&e(_.removeEvent(n.editEvent.event.id)),e(W.actions.endEditEvent())}},J={isEditing:e=>e.editEvent.isEditing,event:e=>e.editEvent.event},L=()=>{let e=(0,s.wA)(),t=(0,s.d4)(J.isEditing),n=(0,s.d4)(J.event),[r,y]=(0,i.useState)(k.toString((null==n?void 0:n.start)||0));(0,i.useEffect)(()=>{t&&n&&y(k.toString(n.start))},[t]);let p=()=>{e(Z.cancelEditEvent())},g=t=>{let a=Object.assign({},n,t);e(Z.updateEditEvent(a))};return t&&n?(0,a.jsx)(l.A,{visible:t,onDismiss:e=>"closeButton"===e.detail.reason&&p(),size:"medium",footer:(0,a.jsxs)(d.A,{display:"block",children:[(0,a.jsx)(d.A,{float:"left",textAlign:"left",children:(0,a.jsx)(o.A,{variant:"normal",onClick:()=>{e(Z.deleteEvent())},children:"Delete"})}),(0,a.jsxs)(d.A,{float:"right",children:[(0,a.jsx)(o.A,{variant:"link",onClick:p,children:"Cancel"}),(0,a.jsx)(o.A,{disabled:!(e=>!!e&&!!e.name&&!isNaN(e.start)&&!isNaN(e.duration)&&e.duration>0&&e.days.length>0)(n),variant:"primary",onClick:()=>{e(Z.saveEditEvent())},children:"Save"})]})]}),header:"Editing ".concat(null==n?void 0:n.id),children:(0,a.jsx)(c.A,{children:(0,a.jsxs)(v.A,{direction:"vertical",size:"l",children:[(0,a.jsx)(u.A,{label:"Name",children:(0,a.jsx)(h.A,{value:n.name,placeholder:n.name,invalid:!n.name,onChange:e=>g({name:e.detail.value})})}),(0,a.jsx)(u.A,{label:"Description",children:(0,a.jsx)(h.A,{type:"url",value:(null==n?void 0:n.description)||"",placeholder:null==n?void 0:n.description,onChange:e=>g({description:e.detail.value})})}),(0,a.jsx)(u.A,{label:"Days of week (".concat(n.days.length,")"),children:(0,a.jsx)("div",{style:{},children:(0,a.jsx)(v.A,{direction:"horizontal",size:"xxxs",children:Object.values(b).map(e=>(0,a.jsx)(o.A,{variant:n.days.includes(e)?"normal":"link",onClick:()=>{g({days:n.days.includes(e)?n.days.filter(t=>t!==e):[...n.days,e]})},children:(0,a.jsx)("span",{style:{fontSize:"0.6rem",fontFamily:"monospace"},children:e.slice(0,1)})},e))})})}),(0,a.jsxs)(v.A,{direction:"horizontal",size:"xs",children:[(0,a.jsx)(u.A,{label:"Start time",stretch:!1,children:(0,a.jsx)(E.A,{onChange:e=>{let{detail:t}=e;y(t.value),g({start:k.fromString(t.value)})},value:r,format:"hh:mm",placeholder:"hh:mm"})}),(0,a.jsx)(u.A,{label:"End time",children:(0,a.jsx)(E.A,{disabled:!0,value:k.toString(k.fromString(r)+n.duration),format:"hh:mm",placeholder:"hh:mm"})}),(0,a.jsx)(u.A,{label:"Duration (minutes)",children:(0,a.jsx)(h.A,{type:"number",value:String(n.duration),placeholder:n.duration.toString(),onChange:e=>{let t=parseInt(e.detail.value);!isNaN(t)&&t>0&&g({duration:t})}})})]})]})})}):null};var U=n(83761),q=n(578),K=n(48860),V=n(5751),G=n(18940),Q=n.n(G),X=n(59882),$=n.n(X);let ee=(0,y.Z0)({name:"editEvent",initialState:{inprograss:!1,event:null,enabled:!1,containerHeight:null,yStart:0},reducers:{dragCreateEventStart:(e,t)=>{e.inprograss=!0,e.event=g()(t.payload.e),e.containerHeight=t.payload.height,e.yStart=t.payload.yStart},endEditEvent:e=>{e.inprograss=!1,e.event=null},toggleEnabled:(e,t)=>{e.enabled=$()(t.payload)?!e.enabled:t.payload}}}),et=ee.reducer,en={start:(e,t,n,a,r)=>(i,s)=>{if(!s().dragCreateEvent.enabled)return;let l=r-a,d=r-l;console.log("leooo clientY clientY2",a,d);let o=15*Math.floor(Math.floor((d-t)/n*1440)/15),c=i(_.createEvent({days:[e],start:o}));i(ee.actions.dragCreateEventStart({e:c,height:n,yStart:r}))},move:e=>(t,n)=>{let a=n().dragCreateEvent,r=a.event;if(!a.enabled||!a.inprograss||!r||!a.containerHeight)return;let i=15*Math.floor(Math.floor(Math.abs(e-a.yStart)/a.containerHeight*1440)/15);t(_.upsertEvent({...r,duration:i}))},end:()=>(e,t)=>{let n=t().dragCreateEvent,a=n.event;n.enabled&&n.inprograss&&a&&(e(ee.actions.endEditEvent()),e(Z.startEditEvent(a.id)))},toggleEnabled:ee.actions.toggleEnabled},ea={enabled:e=>e.dragCreateEvent.enabled},er=e=>{let{event:t}=e,n=(0,s.wA)(),r=[...function(e){let t=0;if(!e||0===e.length)return[0,0,0];for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return[t>>16&255,t>>8&255,255&t]}(t.name),.9],i=function(e){let[t,n,a,r=1]=e;return .299*Math.round((t/255*r+ +(1-r))*255)+.587*Math.round((n/255*r+ +(1-r))*255)+.114*Math.round((a/255*r+ +(1-r))*255)>186?[0,0,0]:[255,255,255]}(r);return(0,a.jsxs)("div",{className:"event",style:{backgroundColor:C(r)},onClick:e=>{console.log("event clicked",t.id),n(Z.startEditEvent(t.id)),e.stopPropagation()},children:[(0,a.jsx)("p",{className:"event-name",style:{color:C(i)},children:t.name}),(0,a.jsx)("p",{children:t.description})]})},ei=e=>{let{day:t}=e,n=(0,s.d4)(e=>P.eventsByDay(e.weekEvents,t)),r=e=>{let t=e.start/1440,n=e.duration/1440;return{top:"".concat(100*t,"%"),height:"".concat(100*n,"%")}},l=i.useRef(null),d=(0,s.wA)(),o=A[new Date().getDay()-1]===t,c=i.useRef(null);return(0,i.useEffect)(()=>{if(!o)return;let e=()=>{let e=new Date().getHours(),t=new Date().getMinutes();if(c.current){c.current.style.top="".concat((60*e+t)/1440*100,"%");let[n,a,r]=I();c.current.style.backgroundColor="rgb(".concat(n,", ").concat(a,", ").concat(r,")")}},t=setInterval(e,1e3);return e(),()=>clearInterval(t)},[o]),(0,a.jsxs)("div",{className:"day",onMouseDown:e=>{var n,a,r;(null==(n=l.current)?void 0:n.clientHeight)&&d(en.start(t,null==(a=l.current)?void 0:a.getBoundingClientRect().top,null==(r=l.current)?void 0:r.clientHeight,e.clientY,e.screenY))},children:[(0,a.jsxs)("div",{className:"hour-container",ref:l,children:[Q()(24).map((e,t)=>(0,a.jsx)("div",{className:"hour",children:(0,a.jsx)("span",{children:e})},t)),n.map((e,t)=>(0,a.jsx)("div",{className:"event-position-container",style:r(e),children:(0,a.jsx)(er,{event:e})},t))]}),o&&(0,a.jsx)("div",{className:"time-marker",ref:c})]})};function es(){let e=(0,s.wA)(),t=(0,s.d4)(ea.enabled),n=async()=>{B().then(()=>e(_.reloadFromLocalStorage()))};return(0,a.jsxs)("div",{children:[(0,a.jsx)(U.A,{variant:"gen-ai"}),(0,a.jsxs)(v.A,{direction:"horizontal",size:"l",children:[(0,a.jsx)("h3",{children:"Calandar"}),(0,a.jsx)(q.A,{onChange:()=>e(en.toggleEnabled()),pressed:t,iconName:"lock-private",pressedIconName:"unlocked",children:"Edit"}),(0,a.jsx)(K.A,{dismissButton:!1,position:"top",size:"small",triggerType:"custom",content:(0,a.jsx)(V.A,{type:"success",children:"Copied to clipboard"}),children:(0,a.jsx)(o.A,{iconName:"copy",onClick:z,children:"Copy Calandar"})}),(0,a.jsx)(K.A,{dismissButton:!1,position:"top",size:"small",triggerType:"custom",content:(0,a.jsx)(V.A,{type:"success",children:"Pasted from clipboard"}),children:(0,a.jsx)(o.A,{iconName:"upload",onClick:n,children:"Paste Calandar"})})]}),(0,a.jsxs)("div",{style:{cursor:t?"crosshair":""},className:"week-container",onMouseMove:t=>{e(en.move(t.screenY))},onMouseUp:()=>{e(en.end())},children:[(0,a.jsx)("div",{className:"left-hour-marker",children:Q()(24).map(e=>(0,a.jsxs)("div",{className:"hour-marker",children:[e,":00"]},e))}),Object.values(b).map((e,t)=>(0,a.jsx)(ei,{day:e},t))]})]})}n(11299);let el=(0,y.U1)({reducer:{weekEvents:Y,editEvent:R,dragCreateEvent:et}});function ed(){return(0,i.useEffect)(()=>{(0,r.pW)(r.Vd.Compact),M().forEach(e=>{el.dispatch(_.upsertEvent(e))})},[]),(0,a.jsx)(s.Kq,{store:el,children:(0,a.jsxs)("div",{children:[(0,a.jsx)(L,{}),(0,a.jsx)(es,{})]})})}},95946:(e,t,n)=>{Promise.resolve().then(n.bind(n,80527))}},e=>{var t=t=>e(e.s=t);e.O(0,[936,13,145,984,634,797,441,684,358],()=>t(95946)),_N_E=e.O()}]);